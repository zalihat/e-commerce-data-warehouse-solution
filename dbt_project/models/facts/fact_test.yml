version: 2

models:

  # -----------------------------------
  # fact_order_items
  # -----------------------------------
  - name: fact_order_items
    description: "Fact table for order items with revenue and discount"
    columns:
      - name: order_item_id
        tests:
          - not_null
          - unique

      - name: order_id
        tests:
          - not_null
          - relationships:
              to: ref('fact_orders')
              field: order_id

      - name: product_id
        tests:
          - not_null
          - relationships:
              to: ref('dim_products')
              field: product_id

      - name: quantity
        tests:
          - not_null

      - name: unit_price
        tests:
          - not_null

      - name: discount_amount
        tests:
          - not_null

      - name: revenue
        tests:
          - not_null

      - name: updated_at
        tests:
          - not_null


  # -----------------------------------
  # fact_orders
  # -----------------------------------
  - name: fact_orders
    description: "Fact table for orders"
    columns:
      - name: order_id
        tests:
          - not_null
          - unique

      - name: customer_id
        tests:
          - not_null
          - relationships:
              to: ref('dim_customers')
              field: customer_id

      - name: order_status
        tests:
          - not_null

      - name: total_amount
        tests:
          - not_null

      - name: order_date
        tests:
          - not_null

      - name: updated_at
        tests:
          - not_null


  # -----------------------------------
  # fact_payments
  # -----------------------------------
  - name: fact_payments
    description: "Fact table for payments"
    columns:
      - name: payment_id
        tests:
          - not_null
          - unique

      - name: order_id
        tests:
          - not_null
          - relationships:
              to: ref('fact_orders')
              field: order_id

      - name: payment_provider
        tests:
          - not_null

      - name: payment_amount
        tests:
          - not_null

      - name: payment_status
        tests:
          - not_null

      - name: updated_at
        tests:
          - not_null


  # -----------------------------------
  # fact_shipments
  # -----------------------------------
  - name: fact_shipments
    description: "Fact table for shipments"
    columns:
      - name: shipment_id
        tests:
          - not_null
          - unique

      - name: order_id
        tests:
          - not_null
          - relationships:
              to: ref('fact_orders')
              field: order_id

      - name: shipping_company
        tests:
          - not_null

      - name: shipped_date
        tests:
          - not_null

      - name: tracking_number
        tests:
          - not_null

      - name: updated_at
        tests:
          - not_null
